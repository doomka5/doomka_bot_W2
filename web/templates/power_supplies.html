{% extends "base.html" %}

{% block title %}–ë–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è ‚Äî Doomka W2{% endblock %}

{% block content %}
<section class="page-header">
    <h2>üîå –ë–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è</h2>
    <div class="page-actions">
        <a class="button" href="{{ export_url }}">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</a>
    </div>
</section>

{% if message %}
<div class="alert success">{{ message }}</div>
{% endif %}
{% if error %}
<div class="alert error">{{ error }}</div>
{% endif %}

<form method="get" class="toolbar filters">
    <div class="field-group">
        <label for="search">–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º:</label>
        <input type="text" id="search" name="search" value="{{ search }}" placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∞—Å—Ç—å –∞—Ä—Ç–∏–∫—É–ª–∞ –∏–ª–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏">
    </div>
    <div class="field-group">
        <label for="manufacturer">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</label>
        <select id="manufacturer" name="manufacturer">
            <option value="">–í—Å–µ</option>
            {% for option in filter_options.get('manufacturer', []) %}
                <option value="{{ option.value }}" {% if filters.get('manufacturer') == option.value %}selected{% endif %}>{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="field-group">
        <label for="series">–°–µ—Ä–∏—è:</label>
        <select id="series" name="series">
            <option value="">–í—Å–µ</option>
            {% for option in filter_options.get('series', []) %}
                <option value="{{ option.value }}" {% if filters.get('series') == option.value %}selected{% endif %}>{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="field-group">
        <label for="power">–ú–æ—â–Ω–æ—Å—Ç—å:</label>
        <select id="power" name="power">
            <option value="">–í—Å–µ</option>
            {% for option in filter_options.get('power', []) %}
                <option value="{{ option.value }}" {% if filters.get('power') == option.value %}selected{% endif %}>{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="field-group">
        <label for="voltage">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ:</label>
        <select id="voltage" name="voltage">
            <option value="">–í—Å–µ</option>
            {% for option in filter_options.get('voltage', []) %}
                <option value="{{ option.value }}" {% if filters.get('voltage') == option.value %}selected{% endif %}>{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="field-group">
        <label for="ip">–°—Ç–µ–ø–µ–Ω—å –∑–∞—â–∏—Ç—ã IP:</label>
        <select id="ip" name="ip">
            <option value="">–í—Å–µ</option>
            {% for option in filter_options.get('ip', []) %}
                <option value="{{ option.value }}" {% if filters.get('ip') == option.value %}selected{% endif %}>{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    <input type="hidden" name="sort" value="{{ sort }}">
    <input type="hidden" name="order" value="{{ order }}">
    <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    <a class="button secondary" href="{{ url_for('power_supplies_page') }}">–°–±—Ä–æ—Å–∏—Ç—å</a>
</form>

<div class="table-wrapper">
    <table>
        <thead>
            <tr>
            {% for column in columns %}
                {% set next_order = 'desc' if sort == column.name and order == 'asc' else 'asc' %}
                <th>
                    <a href="{{ url_with_query(request, route_name, search=search, sort=column.name, order=next_order, manufacturer=filters.get('manufacturer'), series=filters.get('series'), power=filters.get('power'), voltage=filters.get('voltage'), ip=filters.get('ip')) }}">
                        {{ column.title }}
                        {% if sort == column.name %}
                            <span class="sort-indicator">{{ '‚Üë' if order == 'asc' else '‚Üì' }}</span>
                        {% endif %}
                    </a>
                </th>
            {% endfor %}
            </tr>
        </thead>
        <tbody>
        {% for row in rows %}
            <tr>
            {% for column in columns %}
                <td>{{ row[column.name] | format_value }}</td>
            {% endfor %}
            </tr>
        {% else %}
            <tr>
                <td class="empty" colspan="{{ columns|length }}">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
