{% extends "base.html" %}

{% block title %}–ü–ª—ë–Ω–∫–∏ ‚Äî Doomka W2{% endblock %}

{% block content %}
<section class="page-header">
    <h2>üéû –ü–ª—ë–Ω–∫–∏</h2>
    <div class="page-actions">
        <a class="button" href="{{ export_url }}">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</a>
    </div>
</section>

{% if message %}
<div class="alert success">{{ message }}</div>
{% endif %}
{% if error %}
<div class="alert error">{{ error }}</div>
{% endif %}

<form method="get" class="toolbar">
    <label for="search">–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º:</label>
    <input type="text" id="search" name="search" value="{{ search }}" placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∞—Å—Ç—å –∞—Ä—Ç–∏–∫—É–ª–∞, —Ü–≤–µ—Ç–∞ –∏–ª–∏ —Å–∫–ª–∞–¥–∞">
    <input type="hidden" name="sort" value="{{ sort }}">
    <input type="hidden" name="order" value="{{ order }}">
    <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    <a class="button secondary" href="{{ url_for('films_page') }}">–°–±—Ä–æ—Å–∏—Ç—å</a>
</form>

<div class="table-wrapper">
    <table>
        <thead>
            <tr>
            {% for column in columns %}
                {% set next_order = 'desc' if sort == column.name and order == 'asc' else 'asc' %}
                <th>
                    <a href="{{ url_with_query(request, route_name, search=search, sort=column.name, order=next_order) }}">
                        {{ column.title }}
                        {% if sort == column.name %}
                            <span class="sort-indicator">{{ '‚Üë' if order == 'asc' else '‚Üì' }}</span>
                        {% endif %}
                    </a>
                </th>
            {% endfor %}
            </tr>
        </thead>
        <tbody>
        {% for row in rows %}
            <tr>
            {% for column in columns %}
                <td>{{ row[column.name] | format_value }}</td>
            {% endfor %}
            </tr>
        {% else %}
            <tr>
                <td class="empty" colspan="{{ columns|length }}">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
